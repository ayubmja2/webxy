import{Q as M,l as g,f as S,w as v,o as c,a as s,d as x,g as N,k as d,p as f,c as b,m as _,F as $,s as h,t as G,A as T}from"./app-B0POS_qi.js";import{_ as z,P as k}from"./Panel-Cm2YOkga.js";import"./ApplicationLogo-1RqGdrda.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const B={class:"p-4"},O={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"},R={class:"space-y-6"},Q={class:"flex justify-between"},j={class:"mb-4 space-y-4"},L=["onUpdate:modelValue"],H=["onUpdate:modelValue"],K=["onUpdate:modelValue"],J=["value"],W=["onClick","disabled"],le={__name:"Edit",setup(X){const{props:V}=M(),r=g(V.recipe||{}),w=g(["Gram (g)","Kilogram (kg)","Ounce (oz)","Pound (lb)","Teaspoon (tsp)","Tablespoon (tbsp)","Cup (c)","Fluid Ounce (fl oz)","Pint (pt)","Quart (qt)","Gallon (gal)","Milliliter (ml)","Liter (l)"]);function q(e){if(!e||e%1===0)return e.toString();const t=1e-6;let l=1,o=0,n=0,m=1,y=e;do{let i=Math.floor(y),u=l;l=i*l+o,o=u,u=n,n=i*n+m,m=u,y=1/(y-i)}while(Math.abs(e-l/n)>e*t);if(l%n===0)return`${l/n}`;{const i=Math.floor(l/n),u=l%n;return i===0?`${l}/${n}`:u===0?`${i}`:`${i} ${u}/${n}`}}function F(e){typeof e!="string"&&(e=e.toString());const t=e.split(" ");let l=0,o=e;t.length>1&&(l=parseFloat(t[0]),o=t[1]);const[n,m]=o.split("/").map(Number);return m?l+n/m:parseFloat(e)}function U(e){const t=parseFloat(e);return!isNaN(t)&&t%1!==0?q(t):e}const a=g({title:r.value.title||"",description:r.value.description||"",instruction:r.value.instruction||"",image_url:null,ingredients:(r.value.ingredients||[]).map(e=>({name:e.name,quantity:U(e.pivot.quantity),unit:e.pivot.unit}))}),p=g(""),C=()=>{a.value.ingredients.push({name:"",quantity:"",unit:w.value[0]}),p.value=""},E=e=>{a.value.ingredients.length>1?a.value.ingredients.splice(e,1):p.value="At least one ingredient is required."},I=e=>{a.value.image_url=e.target.files[0]},P=()=>{let e=!0;return p.value="",a.value.ingredients.length<1&&(p.value="At least one ingredient is required.",e=!1),a.value.ingredients.forEach(t=>{(!t.name||!t.quantity||!t.unit)&&(p.value="All ingredient fields are required.",e=!1)}),e},A=()=>{if(!P())return;const e=new FormData;e.append("title",a.value.title),e.append("description",a.value.description),e.append("instruction",a.value.instruction),a.value.image_url&&e.append("image_url",a.value.image_url),e.append("_method","PATCH"),a.value.ingredients.forEach((t,l)=>{e.append(`ingredients[${l}][name]`,t.name),e.append(`ingredients[${l}][quantity]`,F(t.quantity)),e.append(`ingredients[${l}][unit]`,t.unit)}),h.post(`/recipes/${r.value.id}`,e)},D=()=>{confirm("Are you sure you want to delete this recipe")&&h.delete(`/recipes/${r.value.id}`,{onSuccess:()=>{h.visit("/recipes")},onError:e=>{console.log("Recipe deletion failed",e)}})};return(e,t)=>(c(),S(z,null,{default:v(()=>[s("div",B,[x(k,null,{default:v(()=>[t[9]||(t[9]=s("h1",{class:"text-2xl font-bold mb-6"},"Edit your recipe",-1)),s("form",{onSubmit:N(A,["prevent"])},[s("div",O,[x(k,{class:"space-y-4"},{default:v(()=>[t[4]||(t[4]=s("label",{for:"title",class:"block text-sm font-medium text-gray-700"},"Recipe Name",-1)),d(s("input",{type:"text",id:"title","onUpdate:modelValue":t[0]||(t[0]=l=>a.value.title=l),class:"mt-1 p-2 block w-full rounded-xl border-gray-300 shadow-sm"},null,512),[[f,a.value.title]]),t[5]||(t[5]=s("label",{for:"description",class:"block text-sm font-medium text-gray-700"},"Description",-1)),d(s("textarea",{id:"description","onUpdate:modelValue":t[1]||(t[1]=l=>a.value.description=l),class:"mt-1 p-2 block w-full rounded-2xl border-gray-300 shadow-sm h-40 resize-none"},null,512),[[f,a.value.description]]),t[6]||(t[6]=s("label",{for:"instruction",class:"block text-sm font-medium text-gray-700"},"Instructions",-1)),d(s("textarea",{id:"instruction","onUpdate:modelValue":t[2]||(t[2]=l=>a.value.instruction=l),class:"mt-1 p-2 block w-full rounded-2xl border-gray-300 shadow-sm h-40 resize-none"},null,512),[[f,a.value.instruction]]),s("div",R,[t[3]||(t[3]=s("label",{for:"image",class:"text-sm font-medium text-gray-700"},"Image",-1)),s("div",Q,[s("input",{type:"file",id:"image",onChange:I,class:"mt-1 p-2 block w-1/3 rounded-xl border-gray-300 shadow-sm"},null,32),s("button",{type:"button",onClick:D,class:"bg-red-700 text-mintGreen py-2 px-4 rounded-lg"},"Delete")])])]),_:1}),x(k,null,{default:v(()=>[s("div",j,[t[7]||(t[7]=s("label",{class:"block text-sm font-medium text-gray-700"},"Ingredients",-1)),(c(!0),b($,null,_(a.value.ingredients,(l,o)=>(c(),b("div",{key:o,class:"flex flex-wrap items-center mb-2 space-y-2 md:space-y-0"},[d(s("input",{type:"text","onUpdate:modelValue":n=>l.name=n,placeholder:"Ingredient",class:"block w-full md:w-1/4 p-2 flex-1 rounded-xl border-gray-300 shadow-sm mr-2"},null,8,L),[[f,l.name]]),d(s("input",{type:"text","onUpdate:modelValue":n=>l.quantity=n,placeholder:"e.g., 1 1/2",class:"mr-4 p-2 rounded-md border-gray-300 shadow-sm"},null,8,H),[[f,l.quantity]]),d(s("select",{"onUpdate:modelValue":n=>l.unit=n,class:"mr-2 p-2 rounded-md border-gray-300 shadow-sm unit-select"},[(c(!0),b($,null,_(w.value,n=>(c(),b("option",{key:n,value:n},G(n),9,J))),128))],8,K),[[T,l.unit]]),s("button",{type:"button",onClick:n=>E(o),class:"text-red-500 ml-2",disabled:a.value.ingredients.length===1},"Remove",8,W)]))),128)),s("button",{type:"button",onClick:C,class:"bg-darkOrange text-mintGreen py-2 px-4 rounded-lg"},"Add Ingredient")])]),_:1}),t[8]||(t[8]=s("button",{type:"submit",class:"mt-4 bg-darkOrange text-mintGreen p-3 px-4 rounded-2xl col-span-2 w-3/4 justify-self-center"},"Submit",-1))])],32)]),_:1})])]),_:1}))}};export{le as default};
