import{Q as S,l as g,o as m,f as A,w as v,a as s,b as h,g as N,k as d,p as f,c as b,m as w,F as $,s as y,t as B,B as G}from"./app-D2N4L5H3.js";import{_ as T,P as x}from"./Panel-Xf7c1EYx.js";import"./ApplicationLogo-D3MJSCRR.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const z={class:"p-4"},O=s("h1",{class:"text-2xl font-bold mb-6"},"Edit your recipe",-1),R={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"},Q=s("label",{for:"title",class:"block text-sm font-medium text-gray-700"},"Recipe Name",-1),j=s("label",{for:"description",class:"block text-sm font-medium text-gray-700"},"Description",-1),L=s("label",{for:"instruction",class:"block text-sm font-medium text-gray-700"},"Instructions",-1),H={class:"space-y-6"},K=s("label",{for:"image",class:"text-sm font-medium text-gray-700"},"Image",-1),J={class:"flex justify-between"},W={class:"mb-4 space-y-4"},X=s("label",{class:"block text-sm font-medium text-gray-700"},"Ingredients",-1),Y=["onUpdate:modelValue"],Z=["onUpdate:modelValue"],ee=["onUpdate:modelValue"],te=["value"],ne=["onClick","disabled"],le=s("button",{type:"submit",class:"mt-4 bg-darkOrange text-mintGreen p-3 px-4 rounded-2xl col-span-2 w-3/4 justify-self-center"},"Submit",-1),ue={__name:"Edit",setup(se){const{props:V}=S(),r=g(V.recipe||{}),k=g(["Gram (g)","Kilogram (kg)","Ounce (oz)","Pound (lb)","Teaspoon (tsp)","Tablespoon (tbsp)","Cup (c)","Fluid Ounce (fl oz)","Pint (pt)","Quart (qt)","Gallon (gal)","Milliliter (ml)","Liter (l)"]);function q(e){if(!e||e%1===0)return e.toString();const n=1e-6;let t=1,o=0,l=0,p=1,_=e;do{let i=Math.floor(_),u=t;t=i*t+o,o=u,u=l,l=i*l+p,p=u,_=1/(_-i)}while(Math.abs(e-t/l)>e*n);if(t%l===0)return`${t/l}`;{const i=Math.floor(t/l),u=t%l;return i===0?`${t}/${l}`:u===0?`${i}`:`${i} ${u}/${l}`}}function F(e){typeof e!="string"&&(e=e.toString());const n=e.split(" ");let t=0,o=e;n.length>1&&(t=parseFloat(n[0]),o=n[1]);const[l,p]=o.split("/").map(Number);return p?t+l/p:parseFloat(e)}function U(e){const n=parseFloat(e);return!isNaN(n)&&n%1!==0?q(n):e}const a=g({title:r.value.title||"",description:r.value.description||"",instruction:r.value.instruction||"",image_url:null,ingredients:(r.value.ingredients||[]).map(e=>({name:e.name,quantity:U(e.pivot.quantity),unit:e.pivot.unit}))}),c=g(""),C=()=>{a.value.ingredients.push({name:"",quantity:"",unit:k.value[0]}),c.value=""},E=e=>{a.value.ingredients.length>1?a.value.ingredients.splice(e,1):c.value="At least one ingredient is required."},I=e=>{a.value.image_url=e.target.files[0]},P=()=>{let e=!0;return c.value="",a.value.ingredients.length<1&&(c.value="At least one ingredient is required.",e=!1),a.value.ingredients.forEach(n=>{(!n.name||!n.quantity||!n.unit)&&(c.value="All ingredient fields are required.",e=!1)}),e},D=()=>{if(!P())return;const e=new FormData;e.append("title",a.value.title),e.append("description",a.value.description),e.append("instruction",a.value.instruction),a.value.image_url&&e.append("image_url",a.value.image_url),e.append("_method","PATCH"),a.value.ingredients.forEach((n,t)=>{e.append(`ingredients[${t}][name]`,n.name),e.append(`ingredients[${t}][quantity]`,F(n.quantity)),e.append(`ingredients[${t}][unit]`,n.unit)}),y.post(`/recipes/${r.value.id}`,e)},M=()=>{confirm("Are you sure you want to delete this recipe")&&y.delete(`/recipes/${r.value.id}`,{onSuccess:()=>{y.visit("/recipes")},onError:e=>{console.log("Recipe deletion failed",e)}})};return(e,n)=>(m(),A(T,null,{default:v(()=>[s("div",z,[h(x,null,{default:v(()=>[O,s("form",{onSubmit:N(D,["prevent"])},[s("div",R,[h(x,{class:"space-y-4"},{default:v(()=>[Q,d(s("input",{type:"text",id:"title","onUpdate:modelValue":n[0]||(n[0]=t=>a.value.title=t),class:"mt-1 p-2 block w-full rounded-xl border-gray-300 shadow-sm"},null,512),[[f,a.value.title]]),j,d(s("textarea",{id:"description","onUpdate:modelValue":n[1]||(n[1]=t=>a.value.description=t),class:"mt-1 p-2 block w-full rounded-2xl border-gray-300 shadow-sm h-40 resize-none"},null,512),[[f,a.value.description]]),L,d(s("textarea",{id:"instruction","onUpdate:modelValue":n[2]||(n[2]=t=>a.value.instruction=t),class:"mt-1 p-2 block w-full rounded-2xl border-gray-300 shadow-sm h-40 resize-none"},null,512),[[f,a.value.instruction]]),s("div",H,[K,s("div",J,[s("input",{type:"file",id:"image",onChange:I,class:"mt-1 p-2 block w-1/3 rounded-xl border-gray-300 shadow-sm"},null,32),s("button",{type:"button",onClick:M,class:"bg-red-700 text-mintGreen py-2 px-4 rounded-lg"},"Delete")])])]),_:1}),h(x,null,{default:v(()=>[s("div",W,[X,(m(!0),b($,null,w(a.value.ingredients,(t,o)=>(m(),b("div",{key:o,class:"flex flex-wrap items-center mb-2 space-y-2 md:space-y-0"},[d(s("input",{type:"text","onUpdate:modelValue":l=>t.name=l,placeholder:"Ingredient",class:"block w-full md:w-1/4 p-2 flex-1 rounded-xl border-gray-300 shadow-sm mr-2"},null,8,Y),[[f,t.name]]),d(s("input",{type:"text","onUpdate:modelValue":l=>t.quantity=l,placeholder:"e.g., 1 1/2",class:"mr-4 p-2 rounded-md border-gray-300 shadow-sm"},null,8,Z),[[f,t.quantity]]),d(s("select",{"onUpdate:modelValue":l=>t.unit=l,class:"mr-2 p-2 rounded-md border-gray-300 shadow-sm unit-select"},[(m(!0),b($,null,w(k.value,l=>(m(),b("option",{key:l,value:l},B(l),9,te))),128))],8,ee),[[G,t.unit]]),s("button",{type:"button",onClick:l=>E(o),class:"text-red-500 ml-2",disabled:a.value.ingredients.length===1},"Remove",8,ne)]))),128)),s("button",{type:"button",onClick:C,class:"bg-darkOrange text-mintGreen py-2 px-4 rounded-lg"},"Add Ingredient")])]),_:1}),le])],32)]),_:1})])]),_:1}))}};export{ue as default};
