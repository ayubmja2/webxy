import{Q as G,k as n,o as a,c as H,w as d,p as f,b as e,u as i,f as r,g as c,d as E,a as u,i as U,m as D,t as x,F as O,l as V,j as J,s as K,x as W}from"./app-CmdjNes7.js";import{_ as Z,P as p}from"./Panel-lvWNy1hL.js";import ee from"./DeleteUserForm-BKv5VIPX.js";import te from"./UpdatePasswordForm-eIuY5jKh.js";import oe from"./UpdateProfileInformationForm-BAwGep6O.js";import{_ as se}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ApplicationLogo-BNN42mTV.js";import"./TextInput-BzJ42kZK.js";import"./PrimaryButton-ggVykreR.js";const _=m=>(K("data-v-348bd70b"),m=m(),W(),m),le={class:"relative"},ae=["src"],re={class:"absolute bottom-0 left-0 right-0 flex items-center justify-center mt-4"},ne={class:"relative"},ie=["src"],ce={key:0,class:"absolute top-0 right-0 m-4"},ue=_(()=>e("i",{class:"fa-solid fa-gear fa-2x"},null,-1)),de=[ue],fe={key:0,class:"absolute right-0 mt-2 bg-white rounded-md shadow-lg z-20"},pe={class:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 cursor-pointer"},_e={class:"container mx-auto mt-4"},me={class:"flex flex-col"},ve={class:"container mx-auto"},he={class:"flex flex-row justify-evenly"},ge={key:0,class:"grid grid-cols-2 p-2"},we={class:"container"},xe=_(()=>e("div",{class:"text-center font-medium text-2xl"},[e("h1",null,"Allergies")],-1)),be={class:"container mx-auto flex flex-col space-y-4 p-6"},ye={class:"container"},ke=_(()=>e("div",{class:"text-center font-medium text-2xl mb-3"},[e("h1",null,"Account Stats")],-1)),Ce={class:"flex flex-row justify-center"},Fe={class:"text-center mb-4"},Pe={key:1,class:"container row-start-2 col-span-2 mt-6"},Ae={class:"flex flex-col"},Ie=_(()=>e("div",{class:"text-center font-medium text-2xl"},[e("h1",null,"Your Food Allergies")],-1)),$e={class:"container mt-8"},Be={class:"grid grid-rows-4 grid-flow-col gap-4 justify-items-center"},Se=["onClick"],je={key:2},Ee=_(()=>e("div",{class:"text-center font-medium text-2xl"},[e("h1",null,"Public Profile")],-1)),Ue={class:"container mt-8"},De={key:1},Oe={key:0,class:"fixed z-10 inset-0 overflow-y-auto"},Ve={class:"flex items-center justify-center min-h-screen"},Ne={class:"bg-white p-6 rounded-center min-h-screen"},Le=_(()=>e("h2",{class:"text-xl mb-4"},"Edit Bio",-1)),Me=_(()=>e("div",{class:"text-center font-medium text-sxl"},[e("h1",null,"Followers")],-1)),Re={class:"container mt-8"},Te={key:3},Ye={class:"p-4 sm:p-8 bg-white shadow sm:rounded-lg"},ze={class:"p-4 sm:p-8 bg-white shadow sm:rounded-lg"},Qe={class:"p-4 sm:p-8 bg-white shadow sm:rounded-lg"},Xe={__name:"Edit",props:{mustVerifyEmail:{type:Boolean},status:{type:String}},setup(m){const{props:s}=G(),F=n(s.user.cover_image_url||""),P=n(s.user.profile_image_url||""),A=n(null),I=n(null),y=n(!1),h=n("public-profile"),k=n(!1),b=n(s.user.bio||""),$=n(s.followers||[]),N=n(s.followersCount||0),B=n(s.recipeCount||0);console.log(B);const L=()=>{k.value=!0},S=()=>{k.value=!1},M=async()=>{try{await f.post("/profile/update-bio",{bio:b.value}),s.user.bio=b.value,S()}catch{alert("Failed to update bio.")}};(async()=>{try{const l=await f.get(`/profile/${s.user.id}/followers`);$.value=l.data.followers}catch{console.log("Error fetching followers:")}})();const R=()=>{y.value=!y.value},T=l=>{const t=l.target.files[0];if(t){const o=new FileReader;o.onload=w=>{F.value=w.target.result},o.readAsDataURL(t)}A.value=t,j("cover_image",A.value)},Y=l=>{const t=l.target.files[0];if(t){const o=new FileReader;o.onload=w=>{P.value=w.target.result},o.readAsDataURL(t)}I.value=t,j("profile_image",I.value)},j=async(l,t)=>{const o=new FormData;o.append(l,t);try{await f.post("/profile/update",o,{headers:{"Content-Type":"multipart/form-data"}})}catch{alert("Failed to update profile.")}},C=l=>{h.value=l},g=n(""),v=n(s.user.allergens||[]),z=async()=>{if(!g.value.trim())return;const l=g.value.trim().toLowerCase();if(!v.value.includes(l))try{const t=await f.post("/profile/update-allergens",{allergens:[...v.value,l]});v.value=t.data.allergens,g.value=""}catch{alert("Failed to update allergens.")}},Q=async l=>{try{const t=await f.post("/profile/update-allergens",{allergens:v.value.filter(o=>o!==l)});v.value=t.data.allergens}catch{alert("Failed to delete allergy.")}},X=async()=>{try{const l=await f.post(`/profile/${s.user.id}/follow`);s.isFollowing=!0}catch{console.log("Error following user")}},q=async()=>{try{const l=await f.post(`/profile/${s.user.id}/unfollow`);s.isFollowing=!1}catch{console.log("Error unfollowing user:")}};return(l,t)=>(a(),H(Z,null,{default:d(()=>[e("div",le,[e("img",{src:F.value||"/default-cover.jpg",alt:"cover art",class:"w-full h-60 object-cover"},null,8,ae),e("div",re,[e("div",ne,[e("img",{src:P.value||"/default-profile.jpg",alt:"profile image",class:"w-24 h-24 rounded-full border-4 border-white object-cover cursor-pointer"},null,8,ie),i(s).isOwnProfile?(a(),r("input",{key:0,type:"file",onChange:Y,accept:"image/*",class:"absolute top-0 left-0 opacity-0 cursor-pointer w-full h-full"},null,32)):c("",!0)])]),i(s).isOwnProfile?(a(),r("div",ce,[e("button",{onClick:R,class:"text-white hover:text-blue-600"},de),y.value?(a(),r("div",fe,[e("label",pe,[e("input",{type:"file",onChange:T,accept:"image/*",class:"hidden"},null,32),E(" Upload Cover Art ")])])):c("",!0)])):c("",!0)]),e("div",_e,[e("div",me,[u(p,null,{default:d(()=>[e("div",ve,[e("ul",he,[e("li",null,[e("button",{onClick:t[0]||(t[0]=o=>C("public-profile")),class:"bg-amber-500 rounded-2xl p-1 px-4"},"Public Profile ")]),e("li",null,[i(s).isOwnProfile?(a(),r("button",{key:0,onClick:t[1]||(t[1]=o=>C("account-info")),class:"bg-amber-500 rounded-2xl p-1 px-4"},"Account Info ")):c("",!0)]),e("li",null,[i(s).isOwnProfile?(a(),r("button",{key:0,onClick:t[2]||(t[2]=o=>C("settings")),class:"bg-amber-500 rounded-2xl p-1 px-4"}," Settings ")):c("",!0)])])])]),_:1}),h.value==="account-info"&&i(s).isOwnProfile?(a(),r("div",ge,[e("div",we,[u(p,{class:"space-y-2 w-1/2 mx-auto"},{default:d(()=>[xe,e("div",be,[U(e("input",{type:"text","onUpdate:modelValue":t[3]||(t[3]=o=>g.value=o),placeholder:"wheat, soy, eggs",class:"rounded-xl"},null,512),[[D,g.value]]),e("button",{onClick:z,class:"bg-amber-500 p-2 rounded-xl"},"Save")])]),_:1})]),e("div",ye,[u(p,{class:"w-3/4 mx-auto"},{default:d(()=>[ke,e("div",Ce,[e("div",Fe,[e("p",null,"You have created "+x(B.value)+" recipes.",1),e("p",null,"You have "+x(N.value)+" followers.",1)])])]),_:1})])])):c("",!0),h.value==="account-info"&&i(s).isOwnProfile?(a(),r("div",Pe,[e("div",Ae,[u(p,null,{default:d(()=>[Ie,e("div",$e,[e("div",null,[e("ul",Be,[(a(!0),r(O,null,V(v.value,o=>(a(),r("li",{key:o,class:"relative bg-amber-500 rounded-2xl p-2 px-4"},[e("span",null,x(o.charAt(0).toUpperCase()+o.slice(1)),1),e("button",{onClick:w=>Q(o),class:"absolute top-1 right-1 text-red-600 font-bold"},"X ",8,Se)]))),128))])])])]),_:1})])])):c("",!0),h.value==="public-profile"?(a(),r("div",je,[u(p,null,{default:d(()=>[Ee,e("div",Ue,[e("div",null,[e("p",null,x(i(s).user.bio||"No bio available."),1),i(s).isOwnProfile?(a(),r("button",{key:0,onClick:L,class:"bg-blue-500 text-white p-2 rounded"},"Edit Bio")):c("",!0),i(s).authUser.id!==i(s).user.id?(a(),r("div",De,[i(s).isFollowing?(a(),r("button",{key:1,onClick:q,class:"bg-red-500 text-white p-2 rounded"}," Unfollow ")):(a(),r("button",{key:0,onClick:X,class:"bg-blue-500 text-white p-2 rounded"},"Follow "))])):c("",!0)])])]),_:1}),k.value?(a(),r("div",Oe,[e("div",Ve,[e("div",Ne,[Le,U(e("textarea",{"onUpdate:modelValue":t[4]||(t[4]=o=>b.value=o),class:"w-full p-2 border rounded mb-4",rows:"4"},null,512),[[D,b.value]]),e("button",{onClick:M,class:"bg-green-500 text-white p-2 rounded"},"Save"),e("button",{onClick:S,class:"bg-red-500 text-white p-2 rounded"},"Cancel")])])])):c("",!0),u(p,null,{default:d(()=>[Me,e("div",Re,[(a(!0),r(O,null,V($.value,o=>(a(),r("ul",{key:o.id,class:"p-2"},[u(i(J),{href:`/profile/${o.id}`,class:"text-blue-500"},{default:d(()=>[E(x(o.name),1)]),_:2},1032,["href"])]))),128))])]),_:1})])):c("",!0),h.value==="settings"&&i(s).isOwnProfile?(a(),r("div",Te,[u(p,null,{default:d(()=>[e("div",Ye,[u(oe,{"must-verify-email":m.mustVerifyEmail,status:m.status,class:"max-w-xl"},null,8,["must-verify-email","status"])]),e("div",ze,[u(te,{class:"max-w-xl"})]),e("div",Qe,[u(ee,{class:"max-w-xl"})])]),_:1})])):c("",!0)])])]),_:1}))}},st=se(Xe,[["__scopeId","data-v-348bd70b"]]);export{st as default};
