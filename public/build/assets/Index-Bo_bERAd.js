import{l as n,x as E,y as j,z as L,f as O,w as m,o as l,a as t,d as u,c as o,m as y,F as _,t as x,k as C,A as U,p as W,g as z,e as J,s as X}from"./app-B0POS_qi.js";import{_ as q,P as w}from"./Panel-Cm2YOkga.js";import{_ as M}from"./RecipeCard-CkqBh5q-.js";import{d as G}from"./Debounce-DarU5fBN.js";import{_ as H}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ApplicationLogo-1RqGdrda.js";const K={class:"mx-5 mt-20"},Q={class:"grid grid-cols-3 gap-2"},Y={class:"flex flex-col space-y-4 text-center"},Z={class:"container"},ee={class:"flex justify-between mb-4"},ae={class:"text-center font-medium"},te={class:"grid grid-cols-2 gap-4 mt-4"},se=["onDrop"],le=["onClick"],oe={class:"container"},re=["value"],ne={class:"flex justify-evenly"},ce={key:0,class:"mt-4 grid grid-cols-2 gap-4 max-md:grid-cols-1"},ie=["onDragstart"],de={key:1},ue={__name:"Index",setup(pe){const R=n("Friday"),c=n(localStorage.getItem("selectedDay")||R.value),D=n([]),g=n(null),p=n(""),h=n([]),f=n(null),r=()=>[{mealType:"Breakfast",recipes:[]},{mealType:"Lunch",recipes:[]},{mealType:"Snack",recipes:[]},{mealType:"Dinner",recipes:[]}],v=n({Sunday:r(),Monday:r(),Tuesday:r(),Wednesday:r(),Thursday:r(),Friday:r(),Saturday:r()}),i=(e,s)=>{console.log(`${s}:`,e)};E(async()=>{try{const e=await axios.get("/meal-plans");e.data&&(v.value={...v.value,...e.data.reduce((d,a)=>(d[a.day]=JSON.parse(a.meals)||r(),d),{})});const s=await axios.get("/categories");D.value=s.data}catch(e){i(e,"Failed to load meal plans or categories")}});const B=e=>{c.value=e,localStorage.setItem("selectedDay",e)},P=e=>{f.value=e},$=e=>{e.preventDefault()},I=async e=>{if(f.value&&e.recipes){e.recipes.push(f.value),f.value=null;try{await b()}catch(s){i(s,"Failed to save meal plan")}}},N=async(e,s)=>{e.recipes.splice(s,1);try{await b()}catch(d){i(d,"Failed to save meal plan after deletion")}},b=async()=>{try{await axios.post("/meal-plans",{day:c.value,meals:v.value[c.value]})}catch(e){i(e,"Failed to save meal plan")}},V=async()=>{try{await axios.delete("/meal-plans",{data:{day:c.value}}),v.value[c.value].forEach(e=>e.recipes=[])}catch(e){i(e,"Failed to delete meal plan")}},A=G(async()=>{if(g.value&&p.value.trim())try{const e=await axios.post("/recipes/search",{category_id:g.value,search:p.value});h.value=e.data}catch(e){i(e,"Failed to search recipes")}else h.value=[]},300);j(p,A);const F=e=>{X.get(`/recipes/${e}`)};return(e,s)=>{const d=L("Button");return l(),O(q,null,{default:m(()=>[t("div",K,[t("div",Q,[u(w,{class:"h-lvh"},{default:m(()=>[t("div",Y,[(l(),o(_,null,y(["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],a=>u(d,{key:a,onClick:z(k=>B(a),["prevent"]),class:"p-2 px-20 bg-darkOrange/90 rounded-2xl"},{default:m(()=>[J(x(a),1)]),_:2},1032,["onClick"])),64))])]),_:1}),u(w,null,{default:m(()=>[t("div",Z,[t("div",ee,[t("h3",ae,x(c.value),1),t("i",{onClick:V,class:"fa-solid fa-trash text-red-600 text-lg cursor-pointer"})]),t("div",te,[(l(!0),o(_,null,y(v.value[c.value],(a,k)=>(l(),o("div",{key:k,class:"border p-4 rounded-lg bg-gray-100",onDragover:$,onDrop:T=>I(a)},[t("h3",null,x(a.mealType),1),(l(!0),o(_,null,y(a.recipes,(T,S)=>(l(),o("div",{key:S,class:"relative mt-4"},[u(M,{class:"my-recipe",recipe:T,navigateToRecipe:F,showBookmark:!1,compact:!0,showFooter:!1},null,8,["recipe"]),t("button",{class:"absolute top-0 right-0 text-red-700 px-2 py-1",onClick:me=>N(a,S)}," X ",8,le)]))),128))],40,se))),128))])])]),_:1}),u(w,null,{default:m(()=>[t("div",oe,[C(t("select",{"onUpdate:modelValue":s[0]||(s[0]=a=>g.value=a),class:"w-full p-2 rounded border text-black"},[s[2]||(s[2]=t("option",{disabled:"",value:null},"Select a Category",-1)),(l(!0),o(_,null,y(D.value,a=>(l(),o("option",{key:a.id,value:a.id},x(a.title),9,re))),128))],512),[[U,g.value]]),C(t("input",{type:"text","onUpdate:modelValue":s[1]||(s[1]=a=>p.value=a),placeholder:"Search Recipes",class:"w-full p-2 mt-4 rounded border"},null,512),[[W,p.value]]),t("div",ne,[h.value.length>0?(l(),o("ul",ce,[(l(!0),o(_,null,y(h.value,a=>(l(),o("li",{key:a.id,class:"p-2 mb-2 flex flex-col",draggable:"true",onDragstart:k=>P(a)},[u(M,{class:"my-recipe",recipe:a,navigateToRecipe:F,showBookmark:!1,compact:!0,showFooter:!1},null,8,["recipe"])],40,ie))),128))])):(l(),o("p",de,"No recipes found"))])])]),_:1})])])]),_:1})}}},ke=H(ue,[["__scopeId","data-v-c84a114e"]]);export{ke as default};
