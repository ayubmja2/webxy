import{Q as D,k as c,y as L,A as N,o as l,c as k,w as x,p as y,b as s,a as w,n as M,d as Q,f as i,t as B,g as v,l as S,F as C,e as j,i as G,m as A,J,q as n,s as H,x as K}from"./app-DR3twzJA.js";import{_ as W,P as T}from"./Panel-B4Yj9s7h.js";import{_ as X}from"./RecipeCard-B4k6PeP-.js";import{_ as Y}from"./UserCard-DtgkIaK3.js";import{_ as Z}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ApplicationLogo-C9C4enog.js";const _=h=>(H("data-v-fe418730"),h=h(),K(),h),ee={class:"w-full p-4 grid grid-cols-1 md:grid-cols-4 gap-4"},se={class:"col-span-1 md:col-span-2 h-full overflow-y-auto"},te={class:"sticky top-0 z-10 flex justify-center space-x-4 mb-4"},ae={key:0,class:"ml-2 bg-darkOrange text-mintGreen rounded-full px-2"},re={key:0,class:"bg-red-200 p-4 mb-4 rounded-lg"},oe=_(()=>s("p",null,"No recipes found. Maybe you should upload one!",-1)),le=[oe],ne={key:1,class:"bg-red-200 p-4 mb-4 rounded-lg"},ue=_(()=>s("p",null,"No users found.",-1)),ce=[ue],ie={key:4},pe={class:"md:block row-start-1 col-span-1 rounded-lg"},de={class:"container bg-green-200 rounded-lg md:mb-8 p-4 row-start-1 md:m-auto"},ve=_(()=>s("h2",{class:"max-md:hidden text-lg font-bold mb-4 text-center"},"Search",-1)),_e={class:"container text-center"},ge=_(()=>s("option",{value:"recipes"},"Recipes",-1)),me=_(()=>s("option",{value:"users"},"Users",-1)),fe=[ge,me],he=_(()=>s("button",{type:"submit",class:"bg-darkOrange text-mintGreen py-2 px-4 rounded-lg md:w-full"},"Search",-1)),xe={class:"hidden md:block row-start-2 bg-green-200 p-4 rounded-lg text-center"},be=_(()=>s("h2",{class:"text-lg font-bold mb-4"},"Collections",-1)),ke=["onClick"],ye={__name:"Index",setup(h){const{props:f}=D(),d=c([]),I=c(0),p=c(!1),g=c(!1),V=c(f.categories),r=c(f.recipes),o=c(f.users),m=c(f.query||""),a=c("recipes"),b=c(f.showFollowing),U=async()=>{try{const e=await y.get("/api/notifications/unread");d.value=e.data}catch(e){console.log(e)}},O=async()=>{try{await y.post("/api/notifications/read"),d.value=[],$("following"),I.value=0}catch(e){console.log(e)}};L(()=>{U(),Echo.private("recipes").listen("RecipeUploaded",e=>{U()}).notification(e=>{d.value.push(e),d.value=[...d.value]})});const E=()=>{r.value.next_page_url?n.get(r.value.next_page_url,{},{preserveScroll:!0,preserveState:!0,onSuccess:e=>{r.value.data=r.value.data.concat(e.props.recipes.data),r.value.next_page_url=e.props.recipes.next_page_url,history.replaceState(null,"","/recipes")}}):a.value==="users"&&o.value.next_page_url&&n.get(o.value.next_page_url,{},{preserveScroll:!0,preserveState:!0,onSuccess:e=>{o.value.data=o.value.data.concat(e.props.users.data),o.value.next_page_url=e.props.users.next_page_url,history.replaceState(null,"","/profile")}})},$=e=>{const u=e==="following"?"/recipes?filter=following":"/recipes";n.get(u,{},{preserveScroll:!0,preserveState:!0,onSuccess:t=>{r.value=t.props.recipes,b.value=t.props.showFollowing}})};N(a,async()=>{m.value="",a.value==="recipes"?await n.visit("/recipes",{preserveScroll:!0,preserveState:!0,onSuccess:e=>{r.value=e.props.recipes,o.value={data:[]},p.value=!1}}):a.value==="users"&&await n.visit("/recipes",{preserveScroll:!0,preserveState:!0,onSuccess:e=>{o.value=e.props.users,r.value={data:[]},p.value=!1}})});const F=async()=>{p.value=!1,g.value=!0,m.value.trim()===""?a.value==="recipes"?await n.visit("/recipes",{preserveScroll:!0,preserveState:!0,onSuccess:e=>{r.value=e.props.recipes,o.value={data:[]},p.value=!1,g.value=!1}}):a.value==="users"&&await n.visit("/recipes",{preserveScroll:!0,preserveState:!0,onSuccess:e=>{o.value=e.props.users,r.value={data:[]},p.value=!1,g.value=!1}}):await n.get("/search",{query:m.value,type:a.value},{preserveState:!0,preserveScroll:!0,onSuccess:e=>{a.value==="recipes"?(r.value=e.props.recipes,o.value={data:[]}):a.value==="users"&&(o.value=e.props.users,r.value={data:[]}),g.value=!1,p.value=!0}})};N(m,e=>{e.trim()===""&&F()});const P=e=>{n.get(`/recipes/${e}`)},R=e=>{n.get(`/profile/${e}`)},q=e=>{n.get(`/categories/${e}`)},z=async e=>{try{await y.post(`/recipes/${e.id}/bookmark`),e.is_bookmarked=!e.is_bookmarked}catch(u){console.log("Error bookmarking recipe:",u)}};return(e,u)=>(l(),k(W,null,{default:x(()=>[s("div",ee,[s("div",se,[s("div",te,[w(T,{class:"container py-3 text-center space-x-8"},{default:x(()=>[s("button",{onClick:u[0]||(u[0]=t=>$("all")),class:M([b.value?"bg-gray-300":"bg-darkOrange text-mintGreen","p-2 px-4 rounded-lg"])},"Explore",2),s("button",{onClick:O,class:M([b.value?"bg-darkOrange text-mintGreen":"bg-gray-300","p-2 px-4 rounded-lg"])},[Q("Following "),d.value.length>0?(l(),i("span",ae,B(d.value.length),1)):v("",!0)],2)]),_:1})]),w(T,null,{default:x(()=>[r.value.data.length===0&&a.value==="recipes"&&p.value&&!g.value?(l(),i("div",re,le)):v("",!0),o.value.data.length===0&&a.value==="users"&&p.value&&!g.value?(l(),i("div",ne,ce)):v("",!0),a.value==="recipes"?(l(!0),i(C,{key:2},S(r.value.data,t=>(l(),k(X,{key:t.id,recipe:t,onToggleBookmark:z,navigateToRecipe:P},null,8,["recipe"]))),128)):v("",!0),a.value==="users"?(l(!0),i(C,{key:3},S(o.value.data,t=>(l(),k(Y,{key:t.id,user:t,navigateToUserProfile:R,class:"mb-6"},null,8,["user"]))),128)):v("",!0),a.value==="recipes"?(l(),i("div",ie,[r.value.next_page_url?(l(),i("button",{key:0,onClick:E,class:"bg-blue-500 text-mintGreen py-2 px-4 rounded-lg mt-4 w-full"}," Load More ")):v("",!0)])):v("",!0)]),_:1})]),s("div",pe,[w(T,null,{default:x(()=>[s("div",de,[ve,s("div",_e,[s("form",{onSubmit:j(F,["prevent"]),class:"max-md:space-x-4"},[G(s("input",{type:"text","onUpdate:modelValue":u[1]||(u[1]=t=>m.value=t),class:"p-2 md:w-full rounded-lg mb-2 max-md:text-center",placeholder:"Search for recipe or user"},null,512),[[A,m.value]]),G(s("select",{"onUpdate:modelValue":u[2]||(u[2]=t=>a.value=t),class:"p-2 md:w-full rounded-lg mb-2 max-md:text-center"},fe,512),[[J,a.value]]),he],32)])]),s("div",xe,[be,(l(!0),i(C,null,S(V.value,t=>(l(),i("div",{key:t.id,class:"mb-2"},[s("button",{class:"bg-darkOrange text-mintGreen py-2 px-4 rounded-xl w-3/4 mb-4",onClick:we=>q(t.id)},B(t.title),9,ke)]))),128))])]),_:1})])])]),_:1}))}},Ne=Z(ye,[["__scopeId","data-v-fe418730"]]);export{Ne as default};
