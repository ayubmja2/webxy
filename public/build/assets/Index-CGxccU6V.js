import{Q as j,k as i,y as D,z as L,o as r,c as F,w as g,p as x,b as t,a as b,n as N,d as T,f as l,t as _,g as d,l as y,F as k,e as P,i as U,m as Q,J,q as p,u as A,j as G,s as H,x as K}from"./app-BH1315As.js";import{_ as O,P as S}from"./Panel-C9nSVQ9T.js";import{_ as W}from"./RecipeCard-8FJfZIHE.js";import{_ as X}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ApplicationLogo-5skrhnF2.js";const m=h=>(H("data-v-fbc6d2be"),h=h(),K(),h),Y={class:"w-full p-4 grid grid-cols-1 md:grid-cols-4 gap-4"},Z={class:"col-span-1 md:col-span-2 h-full overflow-y-auto"},ee={class:"sticky top-0 z-10 flex justify-center space-x-4 mb-4"},te={key:0,class:"ml-2 bg-orange-400 text-white rounded-full px-2"},se={key:0,class:"bg-red-200 p-4 mb-4 rounded-lg"},oe={key:1,class:"bg-red-200 p-4 mb-4 rounded-lg"},ae={class:"flex items-center"},re={class:"flex-1 text-center"},le={class:"text-lg font-bold"},ne={key:4},ce={class:"md:block row-start-1 col-span-1 rounded-lg"},ie={class:"container bg-green-200 rounded-lg md:mb-8 p-4 row-start-1 md:m-auto"},ue=m(()=>t("h2",{class:"max-md:hidden text-lg font-bold mb-4 text-center"},"Search",-1)),de={class:"container text-center"},pe=m(()=>t("option",{value:"recipes"},"Recipes",-1)),ve=m(()=>t("option",{value:"users"},"Users",-1)),ge=[pe,ve],_e=m(()=>t("button",{type:"submit",class:"bg-orange-500 text-white py-2 px-4 rounded-lg md:w-full"},"Search",-1)),me={class:"hidden md:block row-start-2 bg-green-200 p-4 rounded-lg text-center"},he=m(()=>t("h2",{class:"text-lg font-bold mb-4"},"Collections",-1)),fe=["onClick"],xe={__name:"Index",setup(h){const{props:f}=j(),u=i([]),B=i(0),I=i(f.categories),o=i(f.recipes),v=i([]),c=i(f.query||""),n=i("recipes"),w=i(f.showFollowing),C=async()=>{try{const e=await x.get("/api/notifications/unread");u.value=e.data}catch(e){console.log(e)}},M=async()=>{try{await x.post("/api/notifications/read"),u.value=[],$("following"),B.value=0}catch(e){console.log(e)}};D(()=>{C(),Echo.private("recipes").listen("RecipeUploaded",e=>{C()}).notification(e=>{u.value.push(e),u.value=[...u.value]})});const V=()=>{o.value.next_page_url&&p.get(o.value.next_page_url,{},{preserveScroll:!0,preserveState:!0,onSuccess:e=>{o.value.data=o.value.data.concat(e.props.recipes.data),o.value.next_page_url=e.props.recipes.next_page_url,history.replaceState(null,"","/recipes")}})},$=e=>{const a=e==="following"?"/recipes?filter=following":"/recipes";p.get(a,{},{preserveScroll:!0,preserveState:!0,onSuccess:s=>{o.value=s.props.recipes,w.value=s.props.showFollowing}})},E=async()=>{if(c.value.trim()==="")p.visit("/recipes",{preserveScroll:!0,preserveState:!0,onSuccess:e=>{o.value=e.props.recipes,v.value=[]}});else if(n.value==="recipes")p.get("/search",{query:c.value},{preserveState:!0,preserveScroll:!0,onSuccess:e=>{o.value=e.props.recipes,v.value=[],o.value.next_page_url=e.props.recipes.next_page_url}});else if(n.value==="users")try{const e=await x.get(`/search/users?q=${c.value}`);v.value=e.data,o.value={data:[]}}catch(e){console.error("Error fetching users:",e)}};L(c,e=>{e.trim()===""&&p.visit("/recipes",{preserveScroll:!0,preserveState:!0,onSuccess:a=>{o.value=a.props.recipes,v.value=[]}})});const q=e=>{p.get(`/recipes/${e}`)},R=e=>{p.get(`/categories/${e}`)},z=async e=>{try{await x.post(`/recipes/${e.id}/bookmark`),e.is_bookmarked=!e.is_bookmarked}catch(a){console.log("Error bookmarking recipe:",a)}};return(e,a)=>(r(),F(O,null,{default:g(()=>[t("div",Y,[t("div",Z,[t("div",ee,[b(S,{class:"container py-3 text-center space-x-8"},{default:g(()=>[t("button",{onClick:a[0]||(a[0]=s=>$("all")),class:N([w.value?"bg-gray-300":"bg-orange-400 text-white","p-2 px-4 rounded-lg"])},"Explore",2),t("button",{onClick:M,class:N([w.value?"bg-orange-400 text-white":"bg-gray-300","p-2 px-4 rounded-lg"])},[T("Following "),u.value.length>0?(r(),l("span",te,_(u.value.length),1)):d("",!0)],2)]),_:1})]),b(S,null,{default:g(()=>[o.value.data.length===0&&n.value==="recipes"?(r(),l("div",se,[t("p",null,'No recipes found for "'+_(c.value)+'".',1)])):d("",!0),v.value.length===0&&n.value.value==="users"?(r(),l("div",oe,[t("p",null,'No users found for "'+_(c.value)+'".',1)])):d("",!0),n.value==="recipes"?(r(!0),l(k,{key:2},y(o.value.data,s=>(r(),F(W,{key:s.id,recipe:s,onToggleBookmark:z,navigateToRecipe:q},null,8,["recipe"]))),128)):d("",!0),n.value==="users"?(r(!0),l(k,{key:3},y(v.value,s=>(r(),l("div",{key:s.id,class:"bg-green-200 p-4 mb-4 rounded-lg"},[t("div",ae,[t("div",re,[t("h3",le,[b(A(G),{href:`/profile/${s.id}`,class:"text-blue-500"},{default:g(()=>[T(_(s.name),1)]),_:2},1032,["href"])])])])]))),128)):d("",!0),n.value==="recipes"?(r(),l("div",ne,[o.value.next_page_url?(r(),l("button",{key:0,onClick:V,class:"bg-blue-500 text-white py-2 px-4 rounded-lg mt-4 w-full"}," Load More ")):d("",!0)])):d("",!0)]),_:1})]),t("div",ce,[b(S,null,{default:g(()=>[t("div",ie,[ue,t("div",de,[t("form",{onSubmit:P(E,["prevent"]),class:"max-md:space-x-4"},[U(t("input",{type:"text","onUpdate:modelValue":a[1]||(a[1]=s=>c.value=s),class:"p-2 md:w-full rounded-lg mb-2 max-md:text-center",placeholder:"Search for recipe or user"},null,512),[[Q,c.value]]),U(t("select",{"onUpdate:modelValue":a[2]||(a[2]=s=>n.value=s),class:"p-2 md:w-full rounded-lg mb-2 max-md:text-center"},ge,512),[[J,n.value]]),_e],32)])]),t("div",me,[he,(r(!0),l(k,null,y(I.value,s=>(r(),l("div",{key:s.id,class:"mb-2"},[t("button",{class:"bg-orange-500 text-white py-2 px-4 rounded-xl w-3/4 mb-4",onClick:be=>R(s.id)},_(s.title),9,fe)]))),128))])]),_:1})])])]),_:1}))}},$e=X(xe,[["__scopeId","data-v-fbc6d2be"]]);export{$e as default};
