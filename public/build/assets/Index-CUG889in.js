import{l as p,z as B,A as E,o as d,f as L,w as c,a as t,b as n,g as y,e as g,t as D,c as i,m as k,F as b,k as M,B as U,p as z,h as A,x as G,y as J,s as X}from"./app-CLGh91mr.js";import{_ as q,P as S}from"./Panel-Ba6yXQ8l.js";import{_ as I}from"./RecipeCard-PBmPz56X.js";import{_ as H}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ApplicationLogo-D8_rgBiO.js";const K=m=>(G("data-v-59f80a74"),m=m(),J(),m),Q={class:"mx-5 mt-20"},Y={class:"grid grid-cols-3 gap-2"},Z={class:"flex flex-col space-y-4"},ee={class:"flex flex-col text-center font-medium text-2xl text-mintGreen space-y-4 mx-auto"},ae={class:"container"},se={class:"flex flex-col"},te={class:"grid grid-rows-1"},le={class:"grid grid-cols-3"},oe={class:"col-start-2 font-medium text-center"},re={class:"grid grid-cols-2 gap-4 mt-4"},ne=["onDrop"],de=["onClick"],ce={class:"container"},ie=K(()=>t("option",{disabled:"",value:null},"Select a Category",-1)),ue=["value"],pe={class:"flex justify-evenly"},ve={key:0,class:"mt-4 grid grid-cols-2 gap-4 max-md:grid-cols-1"},ye=["onDragstart"],ge={key:1},fe={__name:"Index",setup(m){const O=p("Friday"),l=p(O),T=p([]),f=p(null),_=p(""),x=p([]),h=p(null),u=()=>[{mealType:"Breakfast",recipes:[]},{mealType:"Lunch",recipes:[]},{mealType:"Snack",recipes:[]},{mealType:"Dinner",recipes:[]}],o=p({Sunday:u(),Monday:u(),Tuesday:u(),Wednesday:u(),Thursday:u(),Friday:u(),Saturday:u()});B(async()=>{const e=localStorage.getItem("selectedDay");e&&(l.value=e);try{const a=await axios.get("/meal-plans");a.data&&(o.value={...o.value,...a.data.reduce((r,s)=>(r[s.day]=JSON.parse(s.meals)||[...u],r),{})})}catch(a){console.log("Failed to load meal Plans:",a)}});const v=e=>{l.value=e,o.value={...o.value},localStorage.setItem("selectedDay",e)},R=e=>{h.value=e},N=e=>{e.preventDefault()},P=async e=>{if(e.recipes||(e.recipes=[]),h.value){e.recipes=[...e.recipes,h.value],h.value=null,o.value[l.value]=[...o.value[l.value]];try{await axios.post("/meal-plans",{day:l.value,meals:o.value[l.value]})}catch(a){console.error("Failed to save meal plan:",a)}}},V=(e,a)=>{if(e.recipes){e.recipes=e.recipes.slice(),e.recipes.splice(a,1),o.value={...o.value};try{axios.post("/meal-plans",{day:l.value,meals:o.value[l.value]})}catch(r){console.error("Failed to save meal plan after deletion:",r)}}},W=async()=>{try{await axios.delete("/meal-plans",{data:{day:l.value}}),o.value[l.value].forEach(e=>{e.recipes=[]}),console.log("Meal plan deleted successfully")}catch(e){console.error("Failed to delete meal plan:",e)}};B(async()=>{try{const e=await axios.get("/categories");T.value=e.data}catch(e){console.log("Failed to load categories:",e)}});const j=async()=>{if(f.value)try{const e=await axios.post("/recipes/search",{category_id:f.value,search:_.value});_.value?x.value=e.data:x.value=[]}catch(e){console.log("Failed to search recipes:",e)}},w=e=>{X.get(`/recipes/${e}`)};return(e,a)=>{const r=E("Button");return d(),L(q,null,{default:c(()=>[t("div",Q,[t("div",Y,[n(S,{class:"h-lvh"},{default:c(()=>[t("div",Z,[t("div",ee,[n(r,{onClick:a[0]||(a[0]=y(s=>v("Sunday"),["prevent"])),class:"p-2 px-20 bg-darkOrange/90 rounded-2xl"},{default:c(()=>[g("Sunday")]),_:1}),n(r,{onClick:a[1]||(a[1]=y(s=>v("Monday"),["prevent"])),class:"p-2 px-20 bg-darkOrange/90 rounded-2xl"},{default:c(()=>[g("Monday")]),_:1}),n(r,{onClick:a[2]||(a[2]=y(s=>v("Tuesday"),["prevent"])),class:"p-2 px-20 bg-darkOrange/90 rounded-2xl"},{default:c(()=>[g("Tuesday")]),_:1}),n(r,{onClick:a[3]||(a[3]=y(s=>v("Wednesday"),["prevent"])),class:"p-2 px-20 bg-darkOrange/90 rounded-2xl"},{default:c(()=>[g("Wednesday")]),_:1}),n(r,{onClick:a[4]||(a[4]=y(s=>v("Thursday"),["prevent"])),class:"p-2 px-20 bg-darkOrange/90 rounded-2xl"},{default:c(()=>[g("Thursday")]),_:1}),n(r,{onClick:a[5]||(a[5]=y(s=>v("Friday"),["prevent"])),class:"p-2 px-20 bg-darkOrange/90 rounded-2xl"},{default:c(()=>[g("Friday")]),_:1}),n(r,{onClick:a[6]||(a[6]=y(s=>v("Saturday"),["prevent"])),class:"p-2 px-20 bg-darkOrange/90 rounded-2xl"},{default:c(()=>[g("Saturday")]),_:1})])])]),_:1}),n(S,null,{default:c(()=>[t("div",ae,[t("div",se,[t("div",te,[t("div",le,[t("div",oe,D(l.value),1),t("div",{class:"col-start-3 justify-self-end space-x-4"},[t("i",{onClick:W,class:"fa-solid fa-trash my-auto text-red-600 text-lg"})])])]),t("div",re,[(d(!0),i(b,null,k(o.value[l.value],(s,C)=>(d(),i("div",{key:C,class:"border p-4 rounded-lg bg-gray-100",onDragover:N,onDrop:F=>P(s)},[t("h3",null,D(s.mealType),1),(d(!0),i(b,null,k(s.recipes,(F,$)=>(d(),i("div",{key:$,class:"relative mt-4"},[n(I,{class:"my-recipe",recipe:F,navigateToRecipe:w,showBookmark:!1,compact:!0},null,8,["recipe"]),t("button",{class:"absolute top-0 right-0 text-red-700 bg-transparent px-2 py-1",onClick:me=>V(s,$)}," X ",8,de)]))),128))],40,ne))),128))])])])]),_:1}),n(S,null,{default:c(()=>[t("div",ce,[M(t("select",{"onUpdate:modelValue":a[7]||(a[7]=s=>f.value=s),class:"w-full p-2 rounded border text-black"},[ie,(d(!0),i(b,null,k(T.value,s=>(d(),i("option",{key:s.id,value:s.id},D(s.title),9,ue))),128))],512),[[U,f.value]]),M(t("input",{type:"text","onUpdate:modelValue":a[8]||(a[8]=s=>_.value=s),onInput:j,placeholder:"Search Recipes",class:"w-full p-2 mt-4 rounded border"},null,544),[[z,_.value]]),t("div",pe,[x.value.length>0?(d(),i("ul",ve,[(d(!0),i(b,null,k(x.value,s=>(d(),i("li",{key:s.id,class:"p-2 mb-2 flex flex-col",draggable:"true",onDragstart:C=>R(s)},[n(I,{class:"my-recipe",recipe:s,navigateToRecipe:w,showBookmark:!1,compact:!0},null,8,["recipe"])],40,ye))),128))])):f.value!==""?(d(),i("p",ge,"No recipes found")):A("",!0)])])]),_:1})])])]),_:1})}}},De=H(fe,[["__scopeId","data-v-59f80a74"]]);export{De as default};
