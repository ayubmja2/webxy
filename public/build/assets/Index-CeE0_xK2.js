import{Q as D,k as c,y as L,A as B,o as r,c as k,w as _,p as w,b as s,a as h,n as G,d as Q,f as d,t as I,g,l as S,F as C,e as J,i as V,m as H,J as K,u as T,j as U,q as n,s as W,x as X}from"./app-Dl-cv8V6.js";import{_ as Y}from"./AuthenticatedLayout-BHvV00LE.js";import{P as $}from"./Panel-CCHtC7ZE.js";import{_ as Z}from"./RecipeCard-B5sT8fkt.js";import{_ as ee}from"./UserCard-DqqFH9fe.js";import{_ as se}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ApplicationLogo-7S0rSjn0.js";const i=b=>(W("data-v-da57c996"),b=b(),X(),b),te={class:"w-full p-4 grid grid-cols-1 md:grid-cols-4 gap-4"},ae={class:"col-span-1 md:col-span-2 h-full overflow-y-auto"},le={class:"sticky top-0 z-10 flex justify-center space-x-4 mb-4"},oe={key:0,class:"ml-2 bg-darkOrange text-mintGreen rounded-full px-2"},re={key:0,class:"bg-red-200 p-4 mb-4 rounded-lg"},ne=i(()=>s("p",null,"No recipes found. Maybe you should upload one!",-1)),ue=[ne],ce={key:1,class:"bg-red-200 p-4 mb-4 rounded-lg"},ie=i(()=>s("p",null,"No users found.",-1)),de=[ie],pe={key:4},ve={class:"md:block row-start-1 col-span-1 rounded-lg"},_e={class:"container bg-green-200 rounded-lg md:mb-8 p-4 row-start-1 md:m-auto"},ge=i(()=>s("h2",{class:"max-md:hidden text-lg font-bold mb-4 text-center"},"Search",-1)),me={class:"container text-center"},fe=i(()=>s("option",{value:"recipes"},"Recipes",-1)),he=i(()=>s("option",{value:"users"},"Users",-1)),xe=[fe,he],be=i(()=>s("button",{type:"submit",class:"bg-darkOrange text-mintGreen py-2 px-4 rounded-lg md:w-full"},"Search",-1)),ye={class:"hidden md:block row-start-2 bg-green-200 p-4 rounded-lg text-center"},ke=i(()=>s("h2",{class:"text-lg font-bold mb-4"},"Collections",-1)),we=["onClick"],Se={class:"flex justify-center"},Ce={class:"flex space-x-4 ml-2 mt-4"},Te=i(()=>s("li",null,"About",-1)),Ue=i(()=>s("li",null,"Career",-1)),$e=i(()=>s("li",null,"Terms of service",-1)),Fe={__name:"Index",setup(b){const{props:x}=D(),v=c([]),O=c(0),p=c(!1),m=c(!1),E=c(x.categories),l=c(x.recipes),o=c(x.users),f=c(x.query||""),a=c("recipes"),y=c(x.showFollowing),F=async()=>{try{const e=await w.get("/api/notifications/unread");v.value=e.data}catch(e){console.log(e)}},P=async()=>{try{await w.post("/api/notifications/read"),v.value=[],N("following"),O.value=0}catch(e){console.log(e)}};L(()=>{F(),Echo.private("recipes").listen("RecipeUploaded",e=>{F()}).notification(e=>{v.value.push(e),v.value=[...v.value]})});const R=()=>{l.value.next_page_url?n.get(l.value.next_page_url,{},{preserveScroll:!0,preserveState:!0,onSuccess:e=>{l.value.data=l.value.data.concat(e.props.recipes.data),l.value.next_page_url=e.props.recipes.next_page_url,history.replaceState(null,"","/recipes")}}):a.value==="users"&&o.value.next_page_url&&n.get(o.value.next_page_url,{},{preserveScroll:!0,preserveState:!0,onSuccess:e=>{o.value.data=o.value.data.concat(e.props.users.data),o.value.next_page_url=e.props.users.next_page_url,history.replaceState(null,"","/profile")}})},N=e=>{const u=e==="following"?"/recipes?filter=following":"/recipes";n.get(u,{},{preserveScroll:!0,preserveState:!0,onSuccess:t=>{l.value=t.props.recipes,y.value=t.props.showFollowing}})};B(a,async()=>{f.value="",a.value==="recipes"?await n.visit("/recipes",{preserveScroll:!0,preserveState:!0,onSuccess:e=>{l.value=e.props.recipes,o.value={data:[]},p.value=!1}}):a.value==="users"&&await n.visit("/recipes",{preserveScroll:!0,preserveState:!0,onSuccess:e=>{o.value=e.props.users,l.value={data:[]},p.value=!1}})});const M=async()=>{p.value=!1,m.value=!0,f.value.trim()===""?a.value==="recipes"?await n.visit("/recipes",{preserveScroll:!0,preserveState:!0,onSuccess:e=>{l.value=e.props.recipes,o.value={data:[]},p.value=!1,m.value=!1}}):a.value==="users"&&await n.visit("/recipes",{preserveScroll:!0,preserveState:!0,onSuccess:e=>{o.value=e.props.users,l.value={data:[]},p.value=!1,m.value=!1}}):await n.get("/search",{query:f.value,type:a.value},{preserveState:!0,preserveScroll:!0,onSuccess:e=>{a.value==="recipes"?(l.value=e.props.recipes,o.value={data:[]}):a.value==="users"&&(o.value=e.props.users,l.value={data:[]}),m.value=!1,p.value=!0}})};B(f,e=>{e.trim()===""&&M()});const j=e=>{n.get(`/recipes/${e}`)},q=e=>{n.get(`/profile/${e}`)},z=e=>{n.get(`/categories/${e}`)},A=async e=>{try{await w.post(`/recipes/${e.id}/bookmark`),e.is_bookmarked=!e.is_bookmarked}catch(u){console.log("Error bookmarking recipe:",u)}};return(e,u)=>(r(),k(Y,null,{default:_(()=>[s("div",te,[s("div",ae,[s("div",le,[h($,{class:"container py-3 text-center space-x-8"},{default:_(()=>[s("button",{onClick:u[0]||(u[0]=t=>N("all")),class:G([y.value?"bg-gray-300":"bg-darkOrange text-mintGreen","p-2 px-4 rounded-lg"])},"Explore",2),s("button",{onClick:P,class:G([y.value?"bg-darkOrange text-mintGreen":"bg-gray-300","p-2 px-4 rounded-lg"])},[Q("Following "),v.value.length>0?(r(),d("span",oe,I(v.value.length),1)):g("",!0)],2)]),_:1})]),h($,null,{default:_(()=>[l.value.data.length===0&&a.value==="recipes"&&p.value&&!m.value?(r(),d("div",re,ue)):g("",!0),o.value.data.length===0&&a.value==="users"&&p.value&&!m.value?(r(),d("div",ce,de)):g("",!0),a.value==="recipes"?(r(!0),d(C,{key:2},S(l.value.data,t=>(r(),k(Z,{key:t.id,recipe:t,onToggleBookmark:A,navigateToRecipe:j},null,8,["recipe"]))),128)):g("",!0),a.value==="users"?(r(!0),d(C,{key:3},S(o.value.data,t=>(r(),k(ee,{key:t.id,user:t,navigateToUserProfile:q,class:"mb-6"},null,8,["user"]))),128)):g("",!0),a.value==="recipes"?(r(),d("div",pe,[l.value.next_page_url?(r(),d("button",{key:0,onClick:R,class:"bg-blue-500 text-mintGreen py-2 px-4 rounded-lg mt-4 w-full"}," Load More ")):g("",!0)])):g("",!0)]),_:1})]),s("div",ve,[h($,null,{default:_(()=>[s("div",_e,[ge,s("div",me,[s("form",{onSubmit:J(M,["prevent"]),class:"max-md:space-x-4"},[V(s("input",{type:"text","onUpdate:modelValue":u[1]||(u[1]=t=>f.value=t),class:"p-2 md:w-full rounded-lg mb-2 max-md:text-center",placeholder:"Search for recipe or user"},null,512),[[H,f.value]]),V(s("select",{"onUpdate:modelValue":u[2]||(u[2]=t=>a.value=t),class:"p-2 md:w-full rounded-lg mb-2 max-md:text-center"},xe,512),[[K,a.value]]),be],32)])]),s("div",ye,[ke,(r(!0),d(C,null,S(E.value,t=>(r(),d("div",{key:t.id,class:"mb-2"},[s("button",{class:"bg-darkOrange text-mintGreen py-2 px-4 rounded-xl w-3/4 mb-4",onClick:Ne=>z(t.id)},I(t.title),9,we)]))),128))])]),_:1}),s("div",Se,[s("ul",Ce,[h(T(U),null,{default:_(()=>[Te]),_:1}),h(T(U),null,{default:_(()=>[Ue]),_:1}),h(T(U),null,{default:_(()=>[$e]),_:1})])])])])]),_:1}))}},Pe=se(Fe,[["__scopeId","data-v-da57c996"]]);export{Pe as default};
