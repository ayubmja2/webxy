import{Q,k as n,y as j,A as N,o as r,c as b,w as x,p as y,b as s,a as S,n as M,d as A,f as i,t as B,g as v,l as k,F as C,e as J,i as I,m as G,J as H,q as u,s as K,x as O}from"./app-DxNsgg7g.js";import{_ as W,P as T}from"./Panel-4LWzXp7Z.js";import{_ as X}from"./RecipeCard-DA56f2H1.js";import{_ as Y}from"./UserCard-Cg_jcpPX.js";import{_ as Z}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ApplicationLogo-BafG4Pp0.js";const _=h=>(K("data-v-9095ad51"),h=h(),O(),h),ee={class:"w-full p-4 grid grid-cols-1 md:grid-cols-4 gap-4"},se={class:"col-span-1 md:col-span-2 h-full overflow-y-auto"},te={class:"sticky top-0 z-10 flex justify-center space-x-4 mb-4"},ae={key:0,class:"ml-2 bg-orange-400 text-white rounded-full px-2"},oe={key:0,class:"bg-red-200 p-4 mb-4 rounded-lg"},le=_(()=>s("p",null,"No recipes found. Maybe you should upload one!",-1)),re=[le],ue={key:1,class:"bg-red-200 p-4 mb-4 rounded-lg"},ce=_(()=>s("p",null,"No users found.",-1)),ne=[ce],ie={key:4},pe={class:"md:block row-start-1 col-span-1 rounded-lg"},de={class:"container bg-green-200 rounded-lg md:mb-8 p-4 row-start-1 md:m-auto"},ve=_(()=>s("h2",{class:"max-md:hidden text-lg font-bold mb-4 text-center"},"Search",-1)),_e={class:"container text-center"},ge=_(()=>s("option",{value:"recipes"},"Recipes",-1)),fe=_(()=>s("option",{value:"users"},"Users",-1)),me=[ge,fe],he=_(()=>s("button",{type:"submit",class:"bg-orange-500 text-white py-2 px-4 rounded-lg md:w-full"},"Search",-1)),xe={class:"hidden md:block row-start-2 bg-green-200 p-4 rounded-lg text-center"},we=_(()=>s("h2",{class:"text-lg font-bold mb-4"},"Collections",-1)),be=["onClick"],ye={__name:"Index",setup(h){const{props:m}=Q(),d=n([]),V=n(0),p=n(!1),g=n(!1),E=n(m.categories),o=n(m.recipes),l=n(m.users),f=n(m.query||""),a=n("recipes"),w=n(m.showFollowing),U=async()=>{try{const e=await y.get("/api/notifications/unread");d.value=e.data}catch(e){console.log(e)}},P=async()=>{try{await y.post("/api/notifications/read"),d.value=[],$("following"),V.value=0}catch(e){console.log(e)}};j(()=>{U(),Echo.private("recipes").listen("RecipeUploaded",e=>{U()}).notification(e=>{d.value.push(e),d.value=[...d.value]})});const R=()=>{o.value.next_page_url?u.get(o.value.next_page_url,{},{preserveScroll:!0,preserveState:!0,onSuccess:e=>{o.value.data=o.value.data.concat(e.props.recipes.data),o.value.next_page_url=e.props.recipes.next_page_url,history.replaceState(null,"","/recipes")}}):a.value==="users"&&l.value.next_page_url&&u.get(l.value.next_page_url,{},{preserveScroll:!0,preserveState:!0,onSuccess:e=>{l.value.data=l.value.data.concat(e.props.users.data),l.value.next_page_url=e.props.users.next_page_url,history.replaceState(null,"","/profile")}})},$=e=>{const c=e==="following"?"/recipes?filter=following":"/recipes";u.get(c,{},{preserveScroll:!0,preserveState:!0,onSuccess:t=>{o.value=t.props.recipes,w.value=t.props.showFollowing}})};N(a,async()=>{f.value="",a.value==="recipes"?await u.visit("/recipes",{preserveScroll:!0,preserveState:!0,onSuccess:e=>{o.value=e.props.recipes,l.value={data:[]},p.value=!1}}):a.value==="users"&&await u.visit("/recipes",{preserveScroll:!0,preserveState:!0,onSuccess:e=>{l.value=e.props.users,o.value={data:[]},p.value=!1}})});const F=async()=>{p.value=!1,g.value=!0,f.value.trim()===""?a.value==="recipes"?await u.visit("/recipes",{preserveScroll:!0,preserveState:!0,onSuccess:e=>{o.value=e.props.recipes,l.value={data:[]},p.value=!1,g.value=!1}}):a.value==="users"&&await u.visit("/recipes",{preserveScroll:!0,preserveState:!0,onSuccess:e=>{l.value=e.props.users,o.value={data:[]},p.value=!1,g.value=!1}}):await u.get("/search",{query:f.value,type:a.value},{preserveState:!0,preserveScroll:!0,onSuccess:e=>{a.value==="recipes"?(o.value=e.props.recipes,l.value={data:[]}):a.value==="users"&&(l.value=e.props.users,o.value={data:[]}),g.value=!1,p.value=!0}})};N(f,e=>{e.trim()===""&&F()});const q=e=>{u.get(`/recipes/${e}`)},z=e=>{u.get(`/profile/${e}`)},D=e=>{u.get(`/categories/${e}`)},L=async e=>{try{await y.post(`/recipes/${e.id}/bookmark`),e.is_bookmarked=!e.is_bookmarked}catch(c){console.log("Error bookmarking recipe:",c)}};return(e,c)=>(r(),b(W,null,{default:x(()=>[s("div",ee,[s("div",se,[s("div",te,[S(T,{class:"container py-3 text-center space-x-8"},{default:x(()=>[s("button",{onClick:c[0]||(c[0]=t=>$("all")),class:M([w.value?"bg-gray-300":"bg-orange-400 text-white","p-2 px-4 rounded-lg"])},"Explore",2),s("button",{onClick:P,class:M([w.value?"bg-orange-400 text-white":"bg-gray-300","p-2 px-4 rounded-lg"])},[A("Following "),d.value.length>0?(r(),i("span",ae,B(d.value.length),1)):v("",!0)],2)]),_:1})]),S(T,null,{default:x(()=>[o.value.data.length===0&&a.value==="recipes"&&p.value&&!g.value?(r(),i("div",oe,re)):v("",!0),l.value.data.length===0&&a.value==="users"&&p.value&&!g.value?(r(),i("div",ue,ne)):v("",!0),a.value==="recipes"?(r(!0),i(C,{key:2},k(o.value.data,t=>(r(),b(X,{key:t.id,recipe:t,onToggleBookmark:L,navigateToRecipe:q},null,8,["recipe"]))),128)):v("",!0),a.value==="users"?(r(!0),i(C,{key:3},k(l.value.data,t=>(r(),b(Y,{key:t.id,user:t,navigateToUserProfile:z,class:"mb-6"},null,8,["user"]))),128)):v("",!0),a.value==="recipes"?(r(),i("div",ie,[o.value.next_page_url?(r(),i("button",{key:0,onClick:R,class:"bg-blue-500 text-white py-2 px-4 rounded-lg mt-4 w-full"}," Load More ")):v("",!0)])):v("",!0)]),_:1})]),s("div",pe,[S(T,null,{default:x(()=>[s("div",de,[ve,s("div",_e,[s("form",{onSubmit:J(F,["prevent"]),class:"max-md:space-x-4"},[I(s("input",{type:"text","onUpdate:modelValue":c[1]||(c[1]=t=>f.value=t),class:"p-2 md:w-full rounded-lg mb-2 max-md:text-center",placeholder:"Search for recipe or user"},null,512),[[G,f.value]]),I(s("select",{"onUpdate:modelValue":c[2]||(c[2]=t=>a.value=t),class:"p-2 md:w-full rounded-lg mb-2 max-md:text-center"},me,512),[[H,a.value]]),he],32)])]),s("div",xe,[we,(r(!0),i(C,null,k(E.value,t=>(r(),i("div",{key:t.id,class:"mb-2"},[s("button",{class:"bg-orange-500 text-white py-2 px-4 rounded-xl w-3/4 mb-4",onClick:Se=>D(t.id)},B(t.title),9,be)]))),128))])]),_:1})])])]),_:1}))}},Ne=Z(ye,[["__scopeId","data-v-9095ad51"]]);export{Ne as default};
