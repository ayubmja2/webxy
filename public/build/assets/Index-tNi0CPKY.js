import{Q,l as c,z as A,D as M,s as u,o as n,f as S,w as _,q as G,a as t,b as g,n as I,e as H,c as d,t as V,h as f,m as w,F as k,g as J,k as B,p as K,B as W,u as C,i as U,x as X,y as Y}from"./app-D2N4L5H3.js";import{_ as Z,P as F}from"./Panel-Xf7c1EYx.js";import{_ as ee}from"./RecipeCard-CzFsmppZ.js";import{_ as te,d as se}from"./Debounce-MZLxOBIq.js";import{_ as ae}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ApplicationLogo-D3MJSCRR.js";const i=x=>(X("data-v-3680de6a"),x=x(),Y(),x),re={class:"w-full p-4 grid grid-cols-1 md:grid-cols-4 gap-4"},le={class:"col-span-1 md:col-span-2 h-full overflow-y-auto"},oe={class:"sticky top-0 z-10 flex justify-center space-x-4 mb-4"},ne={key:0,class:"ml-2 bg-darkOrange text-mintGreen rounded-full px-2"},ue={key:0,class:"bg-red-200 p-4 mb-4 rounded-lg"},ce=i(()=>t("p",null,"No recipes found. Maybe you should upload one!",-1)),ie=[ce],de={key:1,class:"bg-red-200 p-4 mb-4 rounded-lg"},pe=i(()=>t("p",null,"No users found.",-1)),ve=[pe],_e={key:4},fe={class:"md:block row-start-1 col-span-1 rounded-lg"},ge={class:"container bg-green-200 rounded-lg md:mb-8 p-4 row-start-1 md:m-auto"},me=i(()=>t("h2",{class:"max-md:hidden text-lg font-bold mb-4 text-center"},"Search",-1)),he={class:"container text-center"},xe=i(()=>t("option",{value:"recipes"},"Recipes",-1)),ye=i(()=>t("option",{value:"users"},"Users",-1)),be=[xe,ye],Se=i(()=>t("button",{type:"submit",class:"bg-darkOrange text-mintGreen py-2 px-4 rounded-lg md:w-full"},"Search",-1)),we={class:"hidden md:block row-start-2 bg-green-200 p-4 rounded-lg text-center"},ke=i(()=>t("h2",{class:"text-lg font-bold mb-4"},"Collections",-1)),Ce=["onClick"],Ue={class:"flex justify-center"},Fe={class:"flex space-x-4 ml-2 mt-4"},Te=i(()=>t("li",null,"About",-1)),Ne=i(()=>t("li",null,"Career",-1)),$e=i(()=>t("li",null,"Terms of service",-1)),Me={__name:"Index",setup(x){const{props:m}=Q(),p=c([]),O=c(0),v=c(!1),y=c(!1),q=c(m.categories),r=c(m.recipes),o=c(m.users),h=c(m.query||""),a=c("recipes"),b=c(m.showFollowing),T=async()=>{try{const e=await G.get("/api/notifications/unread");p.value=e.data}catch(e){console.log(e)}},E=async()=>{try{await G.post("/api/notifications/read"),p.value=[],N("following"),O.value=0}catch(e){console.log(e)}};A(()=>{T(),Echo.private("recipes").listen("RecipeUploaded",e=>{T()}).notification(e=>{p.value.push(e),p.value=[...p.value]})});const N=e=>{const l=e==="following"?"/recipes?filter=following":"/recipes";u.get(l,{},{preserveScroll:!0,preserveState:!0,onSuccess:s=>{r.value=s.props.recipes,b.value=s.props.showFollowing}})};M(a,async()=>{h.value="",a.value==="recipes"?await u.visit("/recipes",{preserveScroll:!0,preserveState:!0,onSuccess:e=>{r.value=e.props.recipes,o.value={data:[]},v.value=!1}}):a.value==="users"&&await u.visit("/recipes",{preserveScroll:!0,preserveState:!0,onSuccess:e=>{o.value=e.props.users,r.value={data:[]},v.value=!1}})});const $=async()=>{v.value=!1,y.value=!0,await u.get("/search",{query:h.value,type:a.value},{preserveScroll:!0,preserveState:!0,onSuccess:e=>{a.value==="recipes"?(r.value=e.props.recipes,o.value={data:[]}):(o.value=e.props.users,r.value={data:[]}),history.replaceState(null,"","/recipes"),v.value=!0,y.value=!1}})},P=()=>{r.value.next_page_url?u.get(r.value.next_page_url,{},{preserveScroll:!0,preserveState:!0,onSuccess:e=>{r.value.data=r.value.data.concat(e.props.recipes.data),r.value.next_page_url=e.props.recipes.next_page_url,history.replaceState(null,"","/recipes")}}):a.value==="users"&&o.value.next_page_url&&u.get(o.value.next_page_url,{},{preserveScroll:!0,preserveState:!0,onSuccess:e=>{o.value.data=o.value.data.concat(e.props.users.data),o.value.next_page_url=e.props.users.next_page_url,history.replaceState(null,"","/profile")}})},R=async()=>{const e=(a.value==="recipes","/recipes");await u.visit(e,{preserveScroll:!0,preserveState:!0,only:["recipes","users"],onSuccess:l=>{a.value==="recipes"?(r.value=l.props.recipes||{data:[],next_page_url:null},o.value={data:[]}):a.value==="users"&&(o.value=l.props.users||{data:[],next_page_url:null},r.value={data:[]}),v.value=!1}})},z=se(()=>{$()},300);M(h,async e=>{e.trim()===""?await R():z()});const D=e=>{u.get(`/recipes/${e}`,{},{preserveState:!1,preserveScroll:!0})},L=e=>u.get(`/profile/${e}`,{},{preserveScroll:!0,preserveState:!0}),j=e=>{u.get(`/categories/${e}`)};return window.addEventListener("popstate",function(e){const l=window.location.href;(l.includes("?query=")||l.includes("&type="))&&u.get("/recipes",{},{preserveState:!1,preserveScroll:!0})}),(e,l)=>(n(),S(Z,null,{default:_(()=>[t("div",re,[t("div",le,[t("div",oe,[g(F,{class:"container py-3 text-center space-x-8"},{default:_(()=>[t("button",{onClick:l[0]||(l[0]=s=>N("all")),class:I([b.value?"bg-gray-300":"bg-darkOrange text-mintGreen","p-2 px-4 rounded-lg"])},"Explore",2),t("button",{onClick:E,class:I([b.value?"bg-darkOrange text-mintGreen":"bg-gray-300","p-2 px-4 rounded-lg"])},[H("Following "),p.value.length>0?(n(),d("span",ne,V(p.value.length),1)):f("",!0)],2)]),_:1})]),g(F,null,{default:_(()=>[r.value.data.length===0&&a.value==="recipes"&&v.value&&!y.value?(n(),d("div",ue,ie)):f("",!0),o.value.data.length===0&&a.value==="users"&&v.value&&!y.value?(n(),d("div",de,ve)):f("",!0),a.value==="recipes"?(n(!0),d(k,{key:2},w(r.value.data,s=>(n(),S(ee,{key:s.id,recipe:s,navigateToRecipe:D},null,8,["recipe"]))),128)):f("",!0),a.value==="users"?(n(!0),d(k,{key:3},w(o.value.data,s=>(n(),S(te,{key:s.id,user:s,navigateToUserProfile:L,class:"mb-6"},null,8,["user"]))),128)):f("",!0),a.value==="recipes"?(n(),d("div",_e,[r.value.next_page_url?(n(),d("button",{key:0,onClick:P,class:"bg-blue-500 text-mintGreen py-2 px-4 rounded-lg mt-4 w-full"}," Load More ")):f("",!0)])):f("",!0)]),_:1})]),t("div",fe,[g(F,null,{default:_(()=>[t("div",ge,[me,t("div",he,[t("form",{onSubmit:J($,["prevent"]),class:"max-md:space-x-4"},[B(t("input",{type:"text","onUpdate:modelValue":l[1]||(l[1]=s=>h.value=s),class:"p-2 md:w-full rounded-lg mb-2 max-md:text-center",placeholder:"Search for recipe or user"},null,512),[[K,h.value]]),B(t("select",{"onUpdate:modelValue":l[2]||(l[2]=s=>a.value=s),class:"p-2 md:w-full rounded-lg mb-2 max-md:text-center"},be,512),[[W,a.value]]),Se],32)])]),t("div",we,[ke,(n(!0),d(k,null,w(q.value,s=>(n(),d("div",{key:s.id,class:"mb-2"},[t("button",{class:"bg-darkOrange text-mintGreen py-2 px-4 rounded-xl w-3/4 mb-4",onClick:Ge=>j(s.id)},V(s.title),9,Ce)]))),128))])]),_:1}),t("div",Ue,[t("ul",Fe,[g(C(U),{href:e.route("about")},{default:_(()=>[Te]),_:1},8,["href"]),g(C(U),{href:e.route("career")},{default:_(()=>[Ne]),_:1},8,["href"]),g(C(U),{href:e.route("terms")},{default:_(()=>[$e]),_:1},8,["href"])])])])])]),_:1}))}},Pe=ae(Me,[["__scopeId","data-v-3680de6a"]]);export{Pe as default};
